{"version":3,"sources":["byui.js"],"names":["getItem","document","addEventListener","main","courseNumber","location","pathname","split","$","accordion","heightStyle","collapsible","active","accordionErr","console","error","tabs","tabErr","videos","querySelectorAll","i","length","dataset","source","innerHTML","width","height","vidid","videoErr","generateModuleLinks","get","modules","generateModuleLink","moduleId","moduleCount","modNum","querySelector","insertAdjacentHTML","modulesPerRow","resourcesId","lessonCounter","Array","from","classList","includes","validModules","forEach","test","canvasModule","name","push","id","start","href","iLearnTutorial","resources","moduleErr","generateInstructorLink","people","teacher","filter","type","user_id","multipleTeachers","find","teach","log","instructor","instructorErr","window","replace","breadcrumbErr","codeUsed","jsEle","createElement","cssEle","src","rel","head","appendChild","prismErr","add","courseBanner","requestAnimationFrame","style","backgroundImage","breadcrumbWidth","getElementById","offsetWidth","bannerErr"],"mappings":"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","file":"byui.js","sourcesContent":["/*eslint-env node, browser, jquery*/\r\n\r\n/* Allows us to disable this page for testing purposes */\r\nif (localStorage.getItem('devAccount') !== 'true') {\r\n    document.addEventListener('DOMContentLoaded', main);\r\n}\r\n\r\nfunction main() {\r\n    var courseNumber = document.location.pathname.split('/')[2];\r\n\r\n    /* Initialize accordion - JQUERY UI */\r\n    function initializeAccordion() {\r\n        try {\r\n            $('div.accordion').accordion({\r\n                heightStyle: 'content',\r\n                collapsible: true,\r\n                active: false\r\n            });\r\n        } catch (accordionErr) {\r\n            console.error(accordionErr);\r\n        }\r\n    }\r\n\r\n    /* Initialize tabs - JQUERY UI */\r\n    function initializeTabs() {\r\n        try {\r\n            $('#styleguide-tabs-demo-minimal').tabs();\r\n        } catch (tabErr) {\r\n            console.error(tabErr);\r\n        }\r\n    }\r\n\r\n    /* Insert custom video tag generation scripts */\r\n    function insertVideoTag() {\r\n        try {\r\n            var videos = document.querySelectorAll('.byui-video');\r\n            for (var i = 0; i < videos.length; i++) {\r\n                if (videos[i].dataset.source == 'youtube') {\r\n                    videos[i].innerHTML = `<iframe width=\"${videos[i].dataset.width}px\" height=\"${videos[i].dataset.height}px\" src=\"https://www.youtube.com/embed/${videos[i].dataset.vidid}\" frameborder=\"0\" allowfullscreen></iframe>`;\r\n                } else if (videos[i].dataset.source == 'kaltura') {\r\n                    videos[i].innerHTML = `<iframe width=\"${videos[i].dataset.width}px\" height=\"${videos[i].dataset.height}px\" src=\"https://cdnapisec.kaltura.com/p/1157612/sp/115761200/embedIframeJs/uiconf_id/29018071/partner_id/1157612?iframeembed=true&amp;playerId=kaltura_player_1485805514&amp;entry_id=${videos[i].dataset.vidid}&amp;flashvars[streamerType]=auto\" frameborder=\"0\" allowfullscreen></iframe>`;\r\n                }\r\n            }\r\n        } catch (videoErr) {\r\n            console.error(videoErr);\r\n        }\r\n    }\r\n\r\n    /* handles all functions required to generate the course homepage */\r\n    function generateHomePage() {\r\n        /* quit if we are not on the course homepage OR the page is missing the expected format */\r\n        if (document.querySelectorAll('#navigation .steps').length === 0) {\r\n            return;\r\n        }\r\n        var iLearnTutorial = document.querySelector('#tutorial');\r\n        var start = document.querySelector('#start');\r\n        var instructor = document.querySelector('#instructor');\r\n        var resources = document.querySelector('#resources');\r\n\r\n        function generateModuleLinks() {\r\n            try {\r\n                /* get modules */\r\n                $.get('/api/v1/courses/' + courseNumber + '/modules?per_page=30', (modules) => {\r\n                    var resourcesId,\r\n                        lessonWrapperSelector = '#navigation .lessons',\r\n                        lessonCounter = 0;\r\n                    /* Generate a Module link - called by above try statement */\r\n                    function generateModuleLink(moduleId, moduleCount) {\r\n                        var modNum = moduleCount + 1;\r\n                        /* append leading 0 */\r\n                        if (moduleCount + 1 < 10)\r\n                            modNum = `0${moduleCount + 1}`;\r\n                        document.querySelector(lessonWrapperSelector).insertAdjacentHTML('beforeend', `<a href='/courses/${courseNumber}/modules#module_${moduleId}' style='width: calc(100% / ${modulesPerRow} - 20px);'>${modNum}</a>`);\r\n                    }\r\n\r\n                    /* clear lesson div & generate module links if generate class exists */\r\n                    if (Array.from(document.querySelector(lessonWrapperSelector).classList).includes('generate')) {\r\n                        document.querySelector(lessonWrapperSelector).innerHTML = '';\r\n                        /* remove modules with invalid names & get modulesPerRow (limit 7) */\r\n                        var validModules = [];\r\n                        modules.forEach(canvasModule => {\r\n                            if (/(Week|Lesson|Unit)\\s*(1[0-9]|0?\\d(\\D|$))/gi.test(canvasModule.name)) {\r\n                                validModules.push(canvasModule);\r\n                            } else if (/student\\s*resources/i.test(canvasModule.name)) {\r\n                                resourcesId = canvasModule.id;\r\n                            }\r\n                        });\r\n                        var modulesPerRow = validModules.length > 7 ? 7 : validModules.length;\r\n\r\n                        /* generate module links */\r\n                        validModules.forEach((canvasModule) => {\r\n                            generateModuleLink(canvasModule.id, lessonCounter);\r\n                            lessonCounter++;\r\n                        });\r\n                    }\r\n\r\n                    /* set home page buttons */\r\n                    if (start)\r\n                        start.href = `/courses/${courseNumber}/modules#module_${modules[0].id}`;\r\n                    if (iLearnTutorial)\r\n                        iLearnTutorial.href = 'http://byu-idaho.screenstepslive.com/s/16998/m/76692/l/865828-canvas-student-orientation?token=aq7F_UOmeDIj-6lBVDaXBdOQ01pfx1jw';\r\n                    if (resources)\r\n                        resources.href = `/courses/${courseNumber}/modules#module_${resourcesId}`;\r\n                });\r\n            } catch (moduleErr) {\r\n                console.error(moduleErr);\r\n            }\r\n        }\r\n\r\n        function generateInstructorLink() {\r\n            try {\r\n                /* make the api call to get enrollments */\r\n                $.get(`https://byui.instructure.com/api/v1/courses/${courseNumber}/enrollments?per_page=100`, function (people) {\r\n                    var teacher = people.filter(person => person.type === 'TeacherEnrollment');\r\n                    if (teacher.length > 1) {\r\n                        /* if there are multiple teachers add the link manually */\r\n\r\n                        let id = teacher[0].user_id;\r\n                        let multipleTeachers = teacher.find(teach => teach.user_id !== id) != undefined;\r\n\r\n                        if (multipleTeachers === true) {\r\n                            console.log('Multiple teachers are enrolled in this course. Please add \"Your Instructor\" link manually.');\r\n                            return;\r\n                        }\r\n\r\n                    } else if (teacher.length === 0) {\r\n                        /* if the teacher isn't enrolled for some reason */\r\n                        console.log('Unable to find teacher enrollment.');\r\n                        return;\r\n                    }\r\n\r\n                    /* if we have a teacher fix the button */\r\n                    instructor.href = `/courses/${courseNumber}/users/${teacher[0].user_id}`;\r\n                });\r\n            } catch (instructorErr) {\r\n                console.error(instructorErr);\r\n            }\r\n        }\r\n\r\n        generateModuleLinks();\r\n        generateInstructorLink();\r\n    }\r\n\r\n    /* Hide the 3rd breadcrumb */\r\n    function alterBreadcrumb() {\r\n        try {\r\n            /* If there are 4 total, AND we're inside a course AND we're not in a group tab */\r\n            if (document.querySelectorAll('#breadcrumbs li').length === 4 && /\\.com\\/courses\\/\\d+\\/(?!groups)/i.test(window.location.href)) {\r\n                document.querySelectorAll('#breadcrumbs li:nth-child(3) span')[0].innerHTML = 'Modules';\r\n                /* update the link */\r\n                document.querySelectorAll('#breadcrumbs li:nth-child(3) a')[0].href = document.querySelectorAll('#breadcrumbs li:nth-child(3) a')[0].href.replace(/\\/\\w+$/i, '/modules');\r\n            }\r\n        } catch (breadcrumbErr) {\r\n            console.error(breadcrumbErr);\r\n        }\r\n    }\r\n\r\n    /* enable prism pre > code highlighting */\r\n    function prismHighlighting() {\r\n        try {\r\n            let codeUsed = document.querySelector('pre code');\r\n            if (codeUsed == null) return;\r\n\r\n            let jsEle = document.createElement('script'),\r\n                cssEle = document.createElement('link');\r\n            jsEle.src = 'https://content.byui.edu/integ/gen/a40c34d7-9f6f-4a18-a41d-2f40e2b2a18e/0/codeHighlighter.js';\r\n            cssEle.href = 'https://content.byui.edu/integ/gen/a40c34d7-9f6f-4a18-a41d-2f40e2b2a18e/0/codeHighlighter.css';\r\n            cssEle.rel = 'stylesheet';\r\n            document.head.appendChild(jsEle);\r\n            document.head.appendChild(cssEle);\r\n\r\n        } catch (prismErr) {\r\n            console.error(prismErr);\r\n        }\r\n    }\r\n\r\n    /* generate course banner behind breadcrumbs */\r\n    function generateCourseBanner() {\r\n        try {\r\n            // TESTING remove this for production. Applies CSS ONLY to a specific module in a specific course\r\n            /* If we're inside a course */\r\n            if (courseNumber) {\r\n                document.querySelector('body').classList.add('breadcrumbBanner');\r\n                var courseBanner = document.querySelector('.ic-app-nav-toggle-and-crumbs');\r\n\r\n                requestAnimationFrame(() => {\r\n                    /* set background image of courseBanner - Done in JS because URL is dynamic */\r\n                    courseBanner.style.backgroundImage = `url(https://byui.instructure.com/courses/${courseNumber}/file_contents/course%20files/template/courseBanner.jpg)`;\r\n\r\n                    /* get width of breadcrumbs */\r\n                    var breadcrumbWidth = document.getElementById('breadcrumbs').offsetWidth;\r\n\r\n                    const additionalWidth = '450px';\r\n\r\n                    /* set width of fade dynamically. For browsers without CSS variable support */\r\n                    document.querySelector('head').insertAdjacentHTML('beforeend', `<style type='text/css'>\r\n                    .ic-app-nav-toggle-and-crumbs::before {\r\n                    width: calc(${breadcrumbWidth}px + ${additionalWidth}) !important;\r\n                    }\r\n                    </style>`);\r\n                });\r\n            }\r\n        } catch (bannerErr) {\r\n            console.error(bannerErr);\r\n        }\r\n    }\r\n\r\n    initializeAccordion();\r\n    initializeTabs();\r\n    insertVideoTag();\r\n    generateHomePage();\r\n    alterBreadcrumb();\r\n    prismHighlighting();\r\n    generateCourseBanner();\r\n}"]}